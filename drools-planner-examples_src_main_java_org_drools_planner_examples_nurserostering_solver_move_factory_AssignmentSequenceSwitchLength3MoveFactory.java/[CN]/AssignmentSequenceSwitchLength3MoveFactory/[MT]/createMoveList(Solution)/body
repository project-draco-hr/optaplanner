{
  NurseRoster nurseRoster=(NurseRoster)solution;
  List<Employee> employeeList=nurseRoster.getEmployeeList();
  List<Assignment> assignmentList=nurseRoster.getAssignmentList();
  Map<Employee,List<AssignmentSequence>> employeeToAssignmentSequenceListMap=new HashMap<Employee,List<AssignmentSequence>>(employeeList.size());
  int assignmentSequenceCapacity=nurseRoster.getShiftDateList().size() + 1 / 2;
  for (  Employee employee : employeeList) {
    employeeToAssignmentSequenceListMap.put(employee,new ArrayList<AssignmentSequence>(assignmentSequenceCapacity));
  }
  for (  Assignment assignment : assignmentList) {
    Employee employee=assignment.getEmployee();
    List<AssignmentSequence> assignmentSequenceList=employeeToAssignmentSequenceListMap.get(employee);
    if (assignmentSequenceList.isEmpty()) {
      AssignmentSequence assignmentSequence=new AssignmentSequence(assignment);
      assignmentSequenceList.add(assignmentSequence);
    }
 else {
      AssignmentSequence lastAssignmentSequence=assignmentSequenceList.get(assignmentSequenceList.size() - 1);
      if (lastAssignmentSequence.belongsHere(assignment)) {
        lastAssignmentSequence.add(assignment);
      }
 else {
        AssignmentSequence assignmentSequence=new AssignmentSequence(assignment);
        assignmentSequenceList.add(assignmentSequence);
      }
    }
  }
  List<Move> moveList=new ArrayList<Move>();
  for (ListIterator<Employee> leftEmployeeIt=employeeList.listIterator(); leftEmployeeIt.hasNext(); ) {
    Employee leftEmployee=leftEmployeeIt.next();
    List<AssignmentSequence> leftAssignmentSequenceList=employeeToAssignmentSequenceListMap.get(leftEmployee);
    for (ListIterator<Employee> rightEmployeeIt=employeeList.listIterator(leftEmployeeIt.nextIndex()); rightEmployeeIt.hasNext(); ) {
      Employee rightEmployee=rightEmployeeIt.next();
      List<AssignmentSequence> rightAssignmentSequenceList=employeeToAssignmentSequenceListMap.get(rightEmployee);
      final int SWITCH_LENGTH=3;
      for (      AssignmentSequence leftAssignmentSequence : leftAssignmentSequenceList) {
        List<Assignment> leftAssignmentList=leftAssignmentSequence.getAssignmentList();
        for (int leftIndex=0; leftIndex <= leftAssignmentList.size() - SWITCH_LENGTH; leftIndex++) {
          for (          AssignmentSequence rightAssignmentSequence : rightAssignmentSequenceList) {
            List<Assignment> rightAssignmentList=rightAssignmentSequence.getAssignmentList();
            for (int rightIndex=0; rightIndex <= rightAssignmentList.size() - SWITCH_LENGTH; rightIndex++) {
              List<Move> subMoveList=new ArrayList<Move>(SWITCH_LENGTH * 2);
              for (              Assignment leftAssignment : leftAssignmentList.subList(leftIndex,leftIndex + SWITCH_LENGTH)) {
                subMoveList.add(new EmployeeChangeMove(leftAssignment,rightEmployee));
              }
              for (              Assignment rightAssignment : rightAssignmentList.subList(rightIndex,rightIndex + SWITCH_LENGTH)) {
                subMoveList.add(new EmployeeChangeMove(rightAssignment,leftEmployee));
              }
              moveList.add(new CompositeMove(subMoveList));
            }
          }
        }
      }
    }
  }
  return moveList;
}
