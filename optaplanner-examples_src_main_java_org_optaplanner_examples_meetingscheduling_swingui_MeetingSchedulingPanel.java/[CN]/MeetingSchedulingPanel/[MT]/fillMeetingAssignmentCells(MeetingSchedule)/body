{
  TangoColorFactory tangoColorFactory=new TangoColorFactory();
  for (  MeetingAssignment meetingAssignment : meetingSchedule.getMeetingAssignmentList()) {
    Color color=tangoColorFactory.pickColor(meetingAssignment.getMeeting());
    TimeGrain startingTimeGrain=meetingAssignment.getStartingTimeGrain();
    TimeGrain lastTimeGrain=startingTimeGrain == null ? null : meetingSchedule.getTimeGrainList().get(startingTimeGrain.getGrainIndex() + meetingAssignment.getMeeting().getDurationInGrains());
    roomsPanel.addCell(startingTimeGrain,meetingAssignment.getRoom(),lastTimeGrain,meetingAssignment.getRoom(),createButton(meetingAssignment,color));
    for (    RequiredAttendance requiredAttendance : meetingAssignment.getMeeting().getRequiredAttendanceList()) {
      personsPanel.addCell(startingTimeGrain,requiredAttendance.getPerson(),lastTimeGrain,requiredAttendance.getPerson(),createButton(meetingAssignment,color));
    }
  }
}
