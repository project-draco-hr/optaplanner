{
  final City newCity=new City();
  newCity.setId(nextCityId);
  nextCityId++;
  newCity.setLongitude(longitude);
  newCity.setLatitude(latitude);
  logger.info("Scheduling insertion of newCity ({}).",newCity);
  solutionBusiness.doProblemFactChange(new ProblemFactChange(){
    public void doChange(    SolutionDirector solutionDirector){
      TravelingSalesmanTour solution=(TravelingSalesmanTour)solutionDirector.getWorkingSolution();
      WorkingMemory workingMemory=solutionDirector.getWorkingMemory();
      solution.getCityList().add(newCity);
      workingMemory.insert(newCity);
      Visit newVisit=new Visit();
      newVisit.setId(newCity.getId());
      newVisit.setCity(newCity);
      solution.getVisitList().add(newVisit);
    }
  }
);
  updatePanel(solutionBusiness.getSolution());
}
