{
  SolverConfig solverConfig=solverFactory.getSolverConfig();
  solverConfig.getTerminationConfig().setMinutesSpentLimit(maximumMinutesSpent);
  solverConfig.setEnvironmentMode(environmentMode);
  Class<? extends SimpleScoreCalculator> simpleScoreCalculatorClass=overwritingSimpleScoreCalculatorClass();
  if (simpleScoreCalculatorClass != null && environmentMode.isAsserted()) {
    ScoreDirectorFactoryConfig assertionScoreDirectorFactoryConfig=new ScoreDirectorFactoryConfig();
    assertionScoreDirectorFactoryConfig.setSimpleScoreCalculatorClass(simpleScoreCalculatorClass);
    solverConfig.getScoreDirectorFactoryConfig().setAssertionScoreDirectorFactory(assertionScoreDirectorFactoryConfig);
  }
  Solver solver=solverFactory.buildSolver();
  solver.solve(planningProblem);
  Solution bestSolution=solver.getBestSolution();
  if (bestSolution == null) {
    bestSolution=planningProblem;
  }
  return bestSolution;
}
