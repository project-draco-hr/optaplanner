{
  if (ObjectUtils.equals(oldStartPeriod,newStartPeriod)) {
    return;
  }
  Task task=taskAssignment.getTask();
  int duration=task.getDuration();
  int retractStart;
  int retractEnd;
  int insertStart;
  int insertEnd;
  if (oldStartPeriod == null) {
    retractStart=-1;
    retractEnd=-1;
    insertStart=newStartPeriod;
    insertEnd=insertStart + duration;
  }
 else   if (newStartPeriod == null) {
    retractStart=oldStartPeriod;
    retractEnd=retractStart + duration;
    insertStart=-1;
    insertEnd=-1;
  }
 else {
    retractStart=oldStartPeriod;
    retractEnd=retractStart + duration;
    insertStart=newStartPeriod;
    insertEnd=insertStart + duration;
    if (oldStartPeriod < newStartPeriod) {
      if (insertStart < retractEnd) {
        int overlap=retractEnd - insertStart;
        retractEnd-=overlap;
        insertStart+=overlap;
      }
    }
 else {
      if (retractStart < insertEnd) {
        int overlap=insertEnd - retractStart;
        insertEnd-=overlap;
        retractStart+=overlap;
      }
    }
  }
  Machine machine=taskAssignment.getMachine();
  List<MachinePeriodPart> machinePeriodList=machinePeriodListMap.get(machine);
  for (int period=retractStart; period < retractEnd; period++) {
    MachinePeriodPart machinePeriodPart=machinePeriodList.get(period);
    machinePeriodPart.removeTaskAssignment(taskAssignment);
    softScore+=CostCalculator.multiplyTwoMicros(task.getPowerConsumptionMicros(),machinePeriodPart.periodPowerCostMicros);
  }
  for (int period=insertStart; period < insertEnd; period++) {
    MachinePeriodPart machinePeriodPart=machinePeriodList.get(period);
    machinePeriodPart.addTaskAssignment(taskAssignment);
    softScore-=CostCalculator.multiplyTwoMicros(task.getPowerConsumptionMicros(),machinePeriodPart.periodPowerCostMicros);
  }
}
