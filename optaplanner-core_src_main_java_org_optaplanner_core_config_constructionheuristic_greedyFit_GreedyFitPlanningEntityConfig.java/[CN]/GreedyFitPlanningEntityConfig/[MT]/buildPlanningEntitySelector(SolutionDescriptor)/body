{
  PlanningEntityDescriptor entityDescriptor;
  if (planningEntityClass != null) {
    if (!solutionDescriptor.hasEntityDescriptor(planningEntityClass)) {
      throw new IllegalArgumentException("The greedyFitPlanningEntity has a planningEntityClass (" + planningEntityClass + ") that has not been configured as a planningEntity.");
    }
    entityDescriptor=solutionDescriptor.getEntityDescriptor(planningEntityClass);
  }
 else {
    Collection<PlanningEntityDescriptor> entityDescriptors=solutionDescriptor.getGenuineEntityDescriptors();
    if (entityDescriptors.size() != 1) {
      throw new IllegalArgumentException("The greedyFitPlanningEntity has no planningEntityClass but there are multiple" + " planningEntityClasses (" + solutionDescriptor.getPlanningEntityClassSet() + ").");
    }
    entityDescriptor=entityDescriptors.iterator().next();
  }
  PlanningEntitySelector planningEntitySelector=new PlanningEntitySelector(entityDescriptor);
  planningEntitySelector.setSelectionOrder(selectionOrder != null ? selectionOrder : PlanningEntitySelectionOrder.ORIGINAL);
  return planningEntitySelector;
}
