{
  List<Move> moveList=new ArrayList<Move>();
  Solution workingSolution=solutionDirector.getWorkingSolution();
  WorkingMemory workingMemory=solutionDirector.getWorkingMemory();
  for (  PlanningEntityDescriptor entityDescriptor : solutionDescriptor.getPlanningEntityDescriptors()) {
    for (    PlanningVariableDescriptor variableDescriptor : entityDescriptor.getPlanningVariableDescriptors()) {
      Map<Object,List<Object>> variableToEntitiesMap=solutionDirector.getVariableToEntitiesMap(variableDescriptor);
      List<Object> entityList=entityDescriptor.extractEntities(workingSolution);
      for (      Object entity : entityList) {
        FactHandle entityFactHandle=workingMemory.getFactHandle(entity);
        if (!variableDescriptor.isTriggerChainCorrection()) {
          for (          Object toPlanningValue : variableDescriptor.extractPlanningValues(workingSolution,entity)) {
            moveList.add(new GenericChangeMove(entity,entityFactHandle,variableDescriptor,toPlanningValue));
          }
        }
 else {
          Object oldChainedEntity=findChainedEntity(variableToEntitiesMap,entity);
          FactHandle oldChainedEntityFactHandle=oldChainedEntity == null ? null : workingMemory.getFactHandle(oldChainedEntity);
          for (          Object toPlanningValue : variableDescriptor.extractPlanningValues(workingSolution,entity)) {
            Object newChainedEntity=findChainedEntity(variableToEntitiesMap,toPlanningValue);
            FactHandle newChainedEntityFactHandle=newChainedEntity == null ? null : workingMemory.getFactHandle(newChainedEntity);
            moveList.add(new GenericChainedChangeMove(entity,entityFactHandle,variableDescriptor,toPlanningValue,oldChainedEntity,oldChainedEntityFactHandle,newChainedEntity,newChainedEntityFactHandle));
          }
        }
      }
    }
  }
  return moveList;
}
