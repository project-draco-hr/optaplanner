{
  List<Move> moveList=new ArrayList<Move>();
  Solution workingSolution=solutionDirector.getWorkingSolution();
  WorkingMemory workingMemory=solutionDirector.getWorkingMemory();
  for (  PlanningEntityDescriptor entityDescriptor : solutionDescriptor.getPlanningEntityDescriptors()) {
    for (    PlanningVariableDescriptor variableDescriptor : entityDescriptor.getPlanningVariableDescriptors()) {
      Map<Object,List<Object>> variableToEntitiesMap=solutionDirector.getVariableToEntitiesMap(variableDescriptor);
      List<Object> entityList=entityDescriptor.extractEntities(workingSolution);
      for (      Object entity : entityList) {
        FactHandle entityFactHandle=workingMemory.getFactHandle(entity);
        if (!variableDescriptor.isChained()) {
          for (          Object toPlanningValue : variableDescriptor.extractPlanningValues(workingSolution,entity)) {
            moveList.add(new GenericChangeMove(entity,entityFactHandle,variableDescriptor,toPlanningValue));
          }
        }
 else {
          Object oldTrailingEntity=findTrailingEntity(variableToEntitiesMap,variableDescriptor,entity);
          FactHandle oldTrailingEntityFactHandle=oldTrailingEntity == null ? null : workingMemory.getFactHandle(oldTrailingEntity);
          for (          Object toPlanningValue : variableDescriptor.extractPlanningValues(workingSolution,entity)) {
            Object newTrailingEntity=findTrailingEntity(variableToEntitiesMap,variableDescriptor,toPlanningValue);
            FactHandle newTrailingEntityFactHandle=newTrailingEntity == null ? null : workingMemory.getFactHandle(newTrailingEntity);
            moveList.add(new GenericChainedChangeMove(entity,entityFactHandle,variableDescriptor,toPlanningValue,oldTrailingEntity,oldTrailingEntityFactHandle,newTrailingEntity,newTrailingEntityFactHandle));
          }
        }
      }
    }
  }
  return moveList;
}
