{
  Object firstEntity=subChain.getFirstEntity();
  Object lastEntity=subChain.getLastEntity();
  Object oldFirstPlanningValue=variableDescriptor.getValue(firstEntity);
  Object oldTrailingEntity=scoreDirector.getTrailingEntity(variableDescriptor,lastEntity);
  Object newTrailingEntity=scoreDirector.getTrailingEntity(variableDescriptor,toPlanningValue);
  if (oldTrailingEntity != null) {
    scoreDirector.beforeVariableChanged(oldTrailingEntity,variableDescriptor.getVariableName());
  }
  for (  Object entity : subChain.getEntityList()) {
    scoreDirector.beforeVariableChanged(entity,variableDescriptor.getVariableName());
  }
  if (newTrailingEntity != null) {
    scoreDirector.beforeVariableChanged(newTrailingEntity,variableDescriptor.getVariableName());
  }
  if (oldTrailingEntity != null) {
    variableDescriptor.setValue(oldTrailingEntity,oldFirstPlanningValue);
  }
  variableDescriptor.setValue(firstEntity,toPlanningValue);
  if (newTrailingEntity != null) {
    variableDescriptor.setValue(newTrailingEntity,lastEntity);
  }
  if (oldTrailingEntity != null) {
    scoreDirector.afterVariableChanged(oldTrailingEntity,variableDescriptor.getVariableName());
  }
  for (  Object entity : subChain.getEntityList()) {
    scoreDirector.afterVariableChanged(entity,variableDescriptor.getVariableName());
  }
  if (newTrailingEntity != null) {
    scoreDirector.afterVariableChanged(newTrailingEntity,variableDescriptor.getVariableName());
  }
}
