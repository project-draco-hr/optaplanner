{
  DefaultSolutionDirector solutionDirector=new DefaultSolutionDirector();
  solutionDirector.setRuleBase(buildRuleBase());
  solutionDirector.setScoreDefinition(new HardAndSoftScoreDefinition());
  NurseRoster nurseRoster=(NurseRoster)new NurseRosteringDaoImpl().readSolution(getClass().getResourceAsStream("/org/drools/planner/examples/nurserostering/data/testNurseRosteringScoreRules.xml"));
  solutionDirector.setWorkingSolution(nurseRoster);
  WorkingMemory workingMemory=solutionDirector.getWorkingMemory();
  Score firstScore=solutionDirector.calculateScoreFromWorkingMemory();
  Employee leftEmployee=findEmployeeById(nurseRoster,0L);
  Assignment leftAssignment=findAssignmentById(nurseRoster,200204001L);
  assertEquals(leftEmployee,leftAssignment.getEmployee());
  Employee rightEmployee=findEmployeeById(nurseRoster,12L);
  Assignment rightAssignment=findAssignmentById(nurseRoster,200204002L);
  assertEquals(rightEmployee,rightAssignment.getEmployee());
  NurseRosteringMoveHelper.moveEmployee(workingMemory,leftAssignment,rightEmployee);
  NurseRosteringMoveHelper.moveEmployee(workingMemory,rightAssignment,leftEmployee);
  solutionDirector.calculateScoreFromWorkingMemory();
  NurseRosteringMoveHelper.moveEmployee(workingMemory,rightAssignment,rightEmployee);
  NurseRosteringMoveHelper.moveEmployee(workingMemory,leftAssignment,leftEmployee);
  Score secondScore=solutionDirector.calculateScoreFromWorkingMemory();
  assertEquals(firstScore,secondScore);
}
