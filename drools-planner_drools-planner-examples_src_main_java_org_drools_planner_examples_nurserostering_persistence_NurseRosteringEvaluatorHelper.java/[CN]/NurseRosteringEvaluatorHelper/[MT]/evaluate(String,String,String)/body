{
  Process process=null;
  try {
    File inputFile=new File(solutionBusiness.getImportDataDir(),filePrefix + ".xml").getCanonicalFile();
    File solvedFile=new File(solutionBusiness.getSolvedDataDir(),filePrefix + fileSuffix + ".xml").getCanonicalFile();
    solutionBusiness.loadSolution(solvedFile);
    HardAndSoftScore score=(HardAndSoftScore)solutionBusiness.getScore();
    File outputFile=new File(solutionBusiness.getExportDataDir(),filePrefix + fileSuffix + ".xml").getCanonicalFile();
    solutionBusiness.exportSolution(outputFile);
    File evaluatorDir=new File("local/competition/nurserostering/");
    String command="java -jar evaluator.jar " + inputFile.getAbsolutePath() + " "+ outputFile.getAbsolutePath();
    process=Runtime.getRuntime().exec(command,null,evaluatorDir);
    EvaluatorSummaryFilterOutputStream out=new EvaluatorSummaryFilterOutputStream(outputFile.getName(),lineContainsFilter);
    IOUtils.copy(process.getInputStream(),out);
    IOUtils.copy(process.getErrorStream(),System.err);
    out.writeResults();
    int penaltyTotal=out.getPenaltyTotal();
    if (score.getHardScore() == 0) {
      if (score.getSoftScore() == (-penaltyTotal)) {
        System.out.println("The calculated soft score (" + score.getSoftScore() + ") is the same as the evaluator penalty total ("+ penaltyTotal+ ").");
      }
 else {
        throw new IllegalStateException("The calculated soft score (" + score.getSoftScore() + ") is not the same as the evaluator penalty total ("+ penaltyTotal+ ").");
      }
    }
  }
 catch (  IOException e) {
    throw new IllegalStateException(e);
  }
 finally {
    if (process != null) {
      process.destroy();
    }
  }
}
