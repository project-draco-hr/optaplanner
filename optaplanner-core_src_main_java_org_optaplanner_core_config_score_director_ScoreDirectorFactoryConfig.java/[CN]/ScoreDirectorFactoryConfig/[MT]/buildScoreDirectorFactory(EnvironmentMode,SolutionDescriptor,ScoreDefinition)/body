{
  AbstractScoreDirectorFactory scoreDirectorFactory;
  scoreDirectorFactory=buildEasyScoreDirectorFactory();
  if (scoreDirectorFactory == null) {
    scoreDirectorFactory=buildIncrementalScoreDirectorFactory();
  }
  if (scoreDirectorFactory == null) {
    scoreDirectorFactory=buildDroolsScoreDirectorFactory();
  }
  scoreDirectorFactory.setSolutionDescriptor(solutionDescriptor);
  scoreDirectorFactory.setScoreDefinition(scoreDefinition);
  if (assertionScoreDirectorFactory != null) {
    if (assertionScoreDirectorFactory.getAssertionScoreDirectorFactory() != null) {
      throw new IllegalArgumentException("A assertionScoreDirectorFactory (" + assertionScoreDirectorFactory + ") cannot have a non-null assertionScoreDirectorFactory ("+ assertionScoreDirectorFactory.getAssertionScoreDirectorFactory()+ ").");
    }
    if (assertionScoreDirectorFactory.getScoreDefinitionClass() != null || assertionScoreDirectorFactory.getScoreDefinitionType() != null) {
      throw new IllegalArgumentException("A assertionScoreDirectorFactory (" + assertionScoreDirectorFactory + ") must reuse the scoreDefinition of its parent."+ " It cannot have a non-null scoreDefinition* property.");
    }
    if (environmentMode.compareTo(EnvironmentMode.FAST_ASSERT) > 0) {
      throw new IllegalArgumentException("A non-null assertionScoreDirectorFactory (" + assertionScoreDirectorFactory + ") requires an environmentMode ("+ environmentMode+ ") of "+ EnvironmentMode.FAST_ASSERT+ " or lower.");
    }
    scoreDirectorFactory.setAssertionScoreDirectorFactory(assertionScoreDirectorFactory.buildScoreDirectorFactory(EnvironmentMode.PRODUCTION,solutionDescriptor,scoreDefinition));
  }
  scoreDirectorFactory.setInitializingScoreTrend(InitializingScoreTrend.parseTrend(initializingScoreTrend == null ? InitializingScoreTrendLevel.ANY.name() : initializingScoreTrend,scoreDefinition.getLevelsSize()));
  if (environmentMode.isNonIntrusiveFullAsserted()) {
    scoreDirectorFactory.setAssertClonedSolution(true);
  }
  return scoreDirectorFactory;
}
