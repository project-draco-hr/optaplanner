{
  if (hasChainedVariables) {
    for (    Map.Entry<PlanningVariableDescriptor,Map<Object,Object>> entry : chainedVariableToTrailingEntityMap.entrySet()) {
      PlanningVariableDescriptor variableDescriptor=entry.getKey();
      if (variableDescriptor.getPlanningEntityDescriptor().appliesToPlanningEntity(entity.getClass())) {
        Object value=variableDescriptor.getValue(entity);
        Map<Object,Object> valueToTrailingEntityMap=entry.getValue();
        Object previousValue=valueToTrailingEntityMap.put(value,entity);
        if (previousValue != null) {
          throw new IllegalArgumentException("The chainedPlanningVariable (" + variableDescriptor.getVariableName() + ") for the entity ("+ entity+ ") is trailing multiple values ("+ value+ ") ("+ previousValue+ ")."+ " This is a theoretically impossible and a bug in Planner.");
        }
      }
    }
  }
}
