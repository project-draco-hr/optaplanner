{
  AgendaItem agendaItem=prepareAgendaItemForUnMatchListener(kcontext);
  if (!constraintMatchEnabled) {
    agendaItem.setActivationUnMatchListener(new ActivationUnMatchListener(){
      public void unMatch(      Session wm,      Match activation){
        undoListener.run();
      }
    }
);
  }
 else {
    final BigDecimalScoreConstraintMatchTotal constraintMatchTotal=findBigDecimalConstraintMatchTotal(kcontext,scoreLevel);
    final BigDecimalScoreConstraintMatch constraintMatch=constraintMatchTotal.addConstraintMatch(kcontext,weight);
    agendaItem.setActivationUnMatchListener(new ActivationUnMatchListener(){
      public void unMatch(      Session wm,      Match activation){
        undoListener.run();
        constraintMatchTotal.removeConstraintMatch(constraintMatch);
      }
    }
);
  }
}
